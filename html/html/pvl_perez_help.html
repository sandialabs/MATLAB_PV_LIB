
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>pvl_perez</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-12-21"><meta name="DC.source" content="pvl_perez_help.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>pvl_perez</h1><!--introduction--><p>Determine sky diffuse irradiance on a tilted surface using the Perez model.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#3">Description</a></li><li><a href="#4">Inputs</a></li><li><a href="#7">Outputs</a></li><li><a href="#9">Example</a></li><li><a href="#11">References</a></li><li><a href="#13">See Also</a></li></ul></div><h2>Syntax<a name="1"></a></h2><p><tt>SkyDiffuse = pvl_perez(SurfTilt, SurfAz, DHI, DNI, HExtra, SunZen, SunAz, AM)</tt></p><p><tt>SkyDiffuse = pvl_perez(SurfTilt, SurfAz, DHI, DNI, HExtra, SunZen, SunAz, AM, model)</tt></p><h2>Description<a name="3"></a></h2><p>The Perez model [3] determines the sky diffuse irradiance on a tilted surface using the surface tilt angle, surface azimuth angle, diffuse horizontal irradiance, direct normal irradiance, extraterrestrial irradiance, sun zenith angle, sun azimuth angle, and relative (not pressure-corrected) airmass. An optional selector may be used to specify any of Perez's model coefficient sets.</p><h2>Inputs<a name="4"></a></h2><div><ul><li><b><tt>SurfTilt</tt></b> - a scalar or vector of surface tilt angles in decimal degrees.     If <tt>SurfTilt</tt> is a vector it must be of the same size as all other vector     inputs. <tt>SurfTilt</tt> must be &gt;=0 and &lt;=180. The tilt angle is defined as     degrees from horizontal (e.g. surface facing up = 0, surface facing     horizon = 90)</li><li><b><tt>SurfAz</tt></b> - a scalar or vector of surface azimuth angles in decimal degrees.     If <tt>SurfAz</tt> is a vector it must be of the same size as all other vector     inputs. <tt>SurfAz</tt> must be &gt;=0 and &lt;=360. The azimuth convention is defined     as degrees east of north (e.g. North = 0, East = 90, West = 270).</li><li><b><tt>DHI</tt></b> - a scalar or vector of diffuse horizontal irradiance in W/m^2.     If <tt>DHI</tt> is a vector it must be of the same size as all other vector inputs.     <tt>DHI</tt> must be &gt;=0.</li><li><b><tt>DNI</tt></b> - a scalar or vector of direct normal irradiance in W/m^2. If     <tt>DNI</tt> is a vector it must be of the same size as all other vector inputs.     <tt>DNI</tt> must be &gt;=0.  If DNI values are not available, it is possible to     use the <a href="pvl_disc_help.html"><tt>pvl_disc</tt></a> function to estimate DNI from     GHI.</li><li><b><tt>HExtra</tt></b> - a scalar or vector of extraterrestrial normal irradiance in     W/m^2. If <tt>HExtra</tt> is a vector it must be of the same size as     all other vector inputs. <tt>HExtra</tt> must be &gt;=0.  HExtra can be     estimated using the <a href="pvl_extraradiation_help"><tt>pvl_extraradiation</tt></a>     function.</li><li><b><tt>SunZen</tt></b> - a scalar or vector of apparent (refraction-corrected) zenith    angles in decimal degrees. If SunZen is a vector it must be of the    same size as all other vector inputs. SunZen must be &gt;=0 and &lt; = 180.    <tt>SunZen</tt> can be calculated using the <a href="pvl_ephemeris_help.html"><tt>pvl_ephemeris</tt></a> function.</li><li><b><tt>SunAz</tt></b> - a scalar or vector of sun azimuth angles in decimal degrees.     If SunAz is a vector it must be of the same size as all other vector     inputs. SunAz must be &gt;=0 and &lt; = 360. The Azimuth convention is defined     as degrees east of north (e.g. North = 0, East = 90, West = 270). <tt>SunAz</tt> can be calculated using the <a href="pvl_ephemeris_help.html"><tt>pvl_ephemeris</tt></a> function.</li><li><b><tt>AM</tt></b> - a scalar or vector of relative (not pressure-corrected) airmass     values. If <tt>AM</tt> is a vector it must be of the same size as all other     vector inputs. <tt>AM</tt> must be &gt;=0. <tt>AM</tt> can be calculated using the     <a href="pvl_relativeairmass_help.html"><tt>pvl_relativeairmass</tt></a> and the     <a href="pvl_absoluteairmass_help.html"><tt>pvl_absoluteairmass</tt></a>  functions.</li><li><b><tt>model</tt></b> - a character string which selects the desired set of Perez     coefficients. If <tt>model</tt> is not provided as an input, the default,     '1990' will be used.  Available values for <tt>model</tt> are:</li></ul></div><div><ul><li><b>'1990'</b> or <b>'allsitescomposite1990'</b> (same as '1990'),</li><li><b>'allsitescomposite1988'</b></li><li><b>'sandiacomposite1988'</b></li><li><b>'usacomposite1988'</b></li><li><b>'france1988'</b></li><li><b>'phoenix1988'</b></li><li><b>'elmonte1988'</b></li><li><b>'osage1988'</b></li><li><b>'albuquerque1988'</b></li><li><b>'capecanaveral1988'</b></li><li><b>'albany1988'</b></li></ul></div><h2>Outputs<a name="7"></a></h2><div><ul><li><b><tt>SkyDiffuse</tt></b> - the sky diffuse irradiance on a tilted surface in W/m^2.     SkyDiffuse is a column vector vector with a number of elements equal to     the input vector(s).</li></ul></div><h2>Example<a name="9"></a></h2><p>Compare all parameter sets</p><pre class="codeinput">clear
SurfTilt = ones(8760,1)*30;
SurfAz = ones(8760,1)*180;
TMYData = pvl_readtmy3(<span class="string">'723650TY.csv'</span>);
TimeMatlab = TMYData.DateNumber;
<span class="comment">%[Y, M, D, H, MN, S] = datevec(TMYData.DateNumber);</span>
Time = pvl_maketimestruct(TimeMatlab, ones(size(TimeMatlab))*TMYData.SiteTimeZone);
HExtra = pvl_extraradiation(pvl_date2doy(Time.year,Time.month,Time.day));
Location = pvl_makelocationstruct(TMYData.SiteLatitude,TMYData.SiteLongitude,TMYData.SiteElevation);
PresPa = TMYData.Pressure*100; <span class="comment">%Convert pressure from mbar to Pa</span>
[SunAz, SunEl, AppSunEl, SolarTime] = pvl_ephemeris(Time,Location,PresPa,TMYData.DryBulb);
SunZen = 90 - AppSunEl;
AM = pvl_relativeairmass(SunZen);
AM(isnan(AM)) = 20;
models = {<span class="string">'1990'</span> <span class="string">'allsitescomposite1988'</span> <span class="string">'sandiacomposite1988'</span> <span class="string">'usacomposite1988'</span> <span class="keyword">...</span>
    <span class="string">'france1988'</span> <span class="string">'phoenix1988'</span> <span class="string">'elmonte1988'</span> <span class="string">'osage1988'</span> <span class="string">'albuquerque1988'</span> <span class="keyword">...</span>
    <span class="string">'capecanaveral1988'</span> <span class="string">'albany1988'</span>};
<span class="keyword">for</span> mod = 1:11
   Ediff(:,mod) = pvl_perez(SurfTilt, SurfAz, TMYData.DHI, TMYData.DNI, HExtra, SunZen, SunAz, AM, models{mod});
<span class="keyword">end</span>
tfilter = and(Time.month == 8,Time.day == 2);
figure
plot(Time.hour(tfilter),Ediff(tfilter,1),<span class="string">'.-b'</span>)
hold <span class="string">all</span>
<span class="keyword">for</span> i=2:11
    plot(Time.hour(tfilter),Ediff(tfilter,i))
<span class="keyword">end</span>
xlim([-5 22])
legend(models,<span class="string">'Location'</span>,<span class="string">'NW'</span>)
xlabel(<span class="string">'Hour of Day'</span>)
ylabel(<span class="string">'Sky Diffuse POA Irradiance (W/m^2)'</span>)
title({<span class="string">'Sky Diffuse Irradiance from the Perez Model'</span>;<span class="string">'Albuquerque - Aug 2'</span>},<span class="string">'FontSize'</span>,14)
</pre><img vspace="5" hspace="5" src="pvl_perez_help_01.png" alt=""> <p>The comparison between different Perez model pararameter sets above demonstrates the sensitivity of this model to the various parameter sets. The differences between models may be due to differences between the underlying quality of the irradiance data used to calibrate each parameter set.  As with any model and especially empirical models such as this one, it is very important to verify parameter sets are adequate and valid for their intended use.</p><h2>References<a name="11"></a></h2><p>[1] Loutzenhiser P.G. et al., 2007. Empirical validation of models to compute   solar irradiance on inclined surfaces for building energy simulation,   Solar Energy vol. 81. pp. 254-267.</p><p>[2] Perez, R., Seals, R., Ineichen, P., Stewart, R., Menicucci, D., 1987. A new   simplified version of the Perez diffuse irradiance model for tilted   surfaces. Solar Energy 39 (3), 221&#8211;232.</p><p>[3] Perez, R., Ineichen, P., Seals, R., Michalsky, J., Stewart, R., 1990.   Modeling daylight availability and irradiance components from direct   and global irradiance. Solar Energy 44 (5), 271&#8211;289.</p><p>[4] Perez, R. et. al 1988. The Development and Verification of the   Perez Diffuse Radiation Model, SAND88-7030, Sandia National   Laboratories.</p><h2>See Also<a name="13"></a></h2><p><a href="pvl_ephemeris_help.html"><tt>pvl_ephemeris</tt></a> , <a href="pvl_extraradiation_help.html"><tt>pvl_extraradiation</tt></a> , <a href="pvl_grounddiffuse_help.html"><tt>pvl_grounddiffuse</tt></a> , <a href="pvl_klucher1979_help.html"><tt>pvl_klucher1979</tt></a> , <a href="pvl_haydavies1980_help.html"><tt>pvl_haydavies1980</tt></a> , <a href="pvl_isotropicsky_help.html"><tt>pvl_isotropicsky</tt></a> , <a href="pvl_kingdiffuse_help.html"><tt>pvl_kingdiffuse</tt></a> , <a href="pvl_relativeairmass_help.html"><tt>pvl_relativeairmass</tt></a> , <a href="pvl_absoluteairmass_help.html"><tt>pvl_absoluteairmass</tt></a></p><p>Copyright 2014 Sandia National Laboratories</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% pvl_perez 
% Determine sky diffuse irradiance on a tilted surface using the Perez model.
%
%% Syntax
%%
% |SkyDiffuse = pvl_perez(SurfTilt, SurfAz, DHI, DNI, HExtra, SunZen,
% SunAz, AM)|
%
% |SkyDiffuse = pvl_perez(SurfTilt, SurfAz, DHI, DNI, HExtra, SunZen,
% SunAz, AM, model)|
%
%% Description
% The Perez model [3] determines the sky diffuse irradiance on a tilted
% surface using the surface tilt angle, surface azimuth angle, diffuse
% horizontal irradiance, direct normal irradiance, extraterrestrial
% irradiance, sun zenith angle, sun azimuth angle, and relative (not
% pressure-corrected) airmass. An optional selector may be used to specify
% any of Perez's model coefficient sets.
%
%% Inputs
%%
% * *|SurfTilt|* - a scalar or vector of surface tilt angles in decimal degrees.
%     If |SurfTilt| is a vector it must be of the same size as all other vector
%     inputs. |SurfTilt| must be >=0 and <=180. The tilt angle is defined as
%     degrees from horizontal (e.g. surface facing up = 0, surface facing
%     horizon = 90)
% * *|SurfAz|* - a scalar or vector of surface azimuth angles in decimal degrees.
%     If |SurfAz| is a vector it must be of the same size as all other vector
%     inputs. |SurfAz| must be >=0 and <=360. The azimuth convention is defined
%     as degrees east of north (e.g. North = 0, East = 90, West = 270).
% * *|DHI|* - a scalar or vector of diffuse horizontal irradiance in W/m^2.
%     If |DHI| is a vector it must be of the same size as all other vector inputs.
%     |DHI| must be >=0.
% * *|DNI|* - a scalar or vector of direct normal irradiance in W/m^2. If
%     |DNI| is a vector it must be of the same size as all other vector inputs.
%     |DNI| must be >=0.  If DNI values are not available, it is possible to
%     use the <pvl_disc_help.html |pvl_disc|> function to estimate DNI from
%     GHI.
% * *|HExtra|* - a scalar or vector of extraterrestrial normal irradiance in
%     W/m^2. If |HExtra| is a vector it must be of the same size as
%     all other vector inputs. |HExtra| must be >=0.  HExtra can be
%     estimated using the <pvl_extraradiation_help |pvl_extraradiation|>
%     function.
% * *|SunZen|* - a scalar or vector of apparent (refraction-corrected) zenith
%    angles in decimal degrees. If SunZen is a vector it must be of the
%    same size as all other vector inputs. SunZen must be >=0 and < = 180.
%    |SunZen| can be calculated using the <pvl_ephemeris_help.html |pvl_ephemeris|> function.
% * *|SunAz|* - a scalar or vector of sun azimuth angles in decimal degrees.
%     If SunAz is a vector it must be of the same size as all other vector
%     inputs. SunAz must be >=0 and < = 360. The Azimuth convention is defined
%     as degrees east of north (e.g. North = 0, East = 90, West = 270).
% |SunAz| can be calculated using the <pvl_ephemeris_help.html |pvl_ephemeris|> function.
% * *|AM|* - a scalar or vector of relative (not pressure-corrected) airmass 
%     values. If |AM| is a vector it must be of the same size as all other 
%     vector inputs. |AM| must be >=0. |AM| can be calculated using the
%     <pvl_relativeairmass_help.html |pvl_relativeairmass|> and the
%     <pvl_absoluteairmass_help.html |pvl_absoluteairmass|>  functions.
% * *|model|* - a character string which selects the desired set of Perez
%     coefficients. If |model| is not provided as an input, the default,
%     '1990' will be used.  Available values for |model| are:
%%
% * *'1990'* or *'allsitescomposite1990'* (same as '1990'),
% * *'allsitescomposite1988'*
% * *'sandiacomposite1988'*
% * *'usacomposite1988'*
% * *'france1988'*
% * *'phoenix1988'*
% * *'elmonte1988'*
% * *'osage1988'*
% * *'albuquerque1988'*
% * *'capecanaveral1988'*
% * *'albany1988'*
%
%% Outputs
%%
% * *|SkyDiffuse|* - the sky diffuse irradiance on a tilted surface in W/m^2.
%     SkyDiffuse is a column vector vector with a number of elements equal to
%     the input vector(s).
%
%% Example
% Compare all parameter sets
clear
SurfTilt = ones(8760,1)*30;
SurfAz = ones(8760,1)*180;
TMYData = pvl_readtmy3('723650TY.csv');
TimeMatlab = TMYData.DateNumber;
%[Y, M, D, H, MN, S] = datevec(TMYData.DateNumber);
Time = pvl_maketimestruct(TimeMatlab, ones(size(TimeMatlab))*TMYData.SiteTimeZone); 
HExtra = pvl_extraradiation(pvl_date2doy(Time.year,Time.month,Time.day));
Location = pvl_makelocationstruct(TMYData.SiteLatitude,TMYData.SiteLongitude,TMYData.SiteElevation);
PresPa = TMYData.Pressure*100; %Convert pressure from mbar to Pa
[SunAz, SunEl, AppSunEl, SolarTime] = pvl_ephemeris(Time,Location,PresPa,TMYData.DryBulb);
SunZen = 90 - AppSunEl;
AM = pvl_relativeairmass(SunZen);
AM(isnan(AM)) = 20;
models = {'1990' 'allsitescomposite1988' 'sandiacomposite1988' 'usacomposite1988' ...
    'france1988' 'phoenix1988' 'elmonte1988' 'osage1988' 'albuquerque1988' ...
    'capecanaveral1988' 'albany1988'};
for mod = 1:11
   Ediff(:,mod) = pvl_perez(SurfTilt, SurfAz, TMYData.DHI, TMYData.DNI, HExtra, SunZen, SunAz, AM, models{mod});
end
tfilter = and(Time.month == 8,Time.day == 2);
figure
plot(Time.hour(tfilter),Ediff(tfilter,1),'.-b')
hold all
for i=2:11
    plot(Time.hour(tfilter),Ediff(tfilter,i))
end
xlim([-5 22])
legend(models,'Location','NW')
xlabel('Hour of Day')
ylabel('Sky Diffuse POA Irradiance (W/m^2)')
title({'Sky Diffuse Irradiance from the Perez Model';'Albuquerque - Aug 2'},'FontSize',14)
%%
% The comparison between different Perez model pararameter sets above
% demonstrates the sensitivity of this model to the various parameter sets.
% The differences between models may be due to differences between
% the underlying quality of the irradiance data used to calibrate each
% parameter set.  As with any model and especially empirical models such as
% this one, it is very important to verify parameter sets are adequate and
% valid for their intended use.
%% References
%%
% [1] Loutzenhiser P.G. et al., 2007. Empirical validation of models to compute
%   solar irradiance on inclined surfaces for building energy simulation, 
%   Solar Energy vol. 81. pp. 254-267.
%
% [2] Perez, R., Seals, R., Ineichen, P., Stewart, R., Menicucci, D., 1987. A new
%   simplified version of the Perez diffuse irradiance model for tilted
%   surfaces. Solar Energy 39 (3), 221–232.
%
% [3] Perez, R., Ineichen, P., Seals, R., Michalsky, J., Stewart, R., 1990.
%   Modeling daylight availability and irradiance components from direct
%   and global irradiance. Solar Energy 44 (5), 271–289.
%
% [4] Perez, R. et. al 1988. The Development and Verification of the
%   Perez Diffuse Radiation Model, SAND88-7030, Sandia National
%   Laboratories.
%
%% See Also
% <pvl_ephemeris_help.html |pvl_ephemeris|> ,
% <pvl_extraradiation_help.html |pvl_extraradiation|> ,
% <pvl_grounddiffuse_help.html |pvl_grounddiffuse|> , 
% <pvl_klucher1979_help.html |pvl_klucher1979|> , 
% <pvl_haydavies1980_help.html |pvl_haydavies1980|> , 
% <pvl_isotropicsky_help.html |pvl_isotropicsky|> , 
% <pvl_kingdiffuse_help.html |pvl_kingdiffuse|> ,
% <pvl_relativeairmass_help.html |pvl_relativeairmass|> ,
% <pvl_absoluteairmass_help.html |pvl_absoluteairmass|>
%%
% Copyright 2014 Sandia National Laboratories

##### SOURCE END #####
--></body></html>